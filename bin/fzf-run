#!/bin/zsh

set -o pipefail

cachedir=${XDG_CACHE_HOME:-"$HOME/.cache"}
last_run="${cachedir}/.last_run"
cache="$cachedir/.run_recent"

truncate -s0 $last_run

touch "$cache"
most_used=$(sort "$cache" | grep -v "^$" | sort | uniq -c | awk '{print $2}')

st -c stfloat -g 60x15 -e zsh -c "fd . $(echo $PATH | tr ':' ' ') -c never -t x -X echo {/} \
    | tr ' ' '\n' | sort -u \
    | fzf --reverse > ${last_run}"

run=$(cat ${last_run})
[ -n "$run" ] && exec "$run"
